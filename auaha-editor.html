<script>

    $('#customFooter').append($('<script src="https://cdn.tiny.cloud/1/2r95o2cgzpvzweghblom1djd4aoinula83gidgqlojsvcx45/tinymce/5/tinymce.min.js" referrerpolicy="origin"><\/script>'));

	var configArray = [{
		//theme : "advanced",
		remove_script_host : false,
		convert_urls : false,
		mode : "none",
		plugins : "pagebreak,save,table,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,-n1ed",
		apiKey: "VGE2DFLT",
		external_plugins: {
			'n1ed': 'https://cdn.jsdelivr.net/gh/KiwiNet-Ltd/JavscriptLibrary@release/n1ed/plugin.js'
		},
		height: 600,
		theme_advanced_layout_manager : "SimpleLayout",
		theme_advanced_toolbar_location : "top",
		theme_advanced_toolbar_align : "left",
			setup : function(ed) {
				ed.ui.registry.addButton('ajaxSave', {
					title : 'Save',
					'class' : 'ajaxSave',
					onclick : function() {
						if(tinyMCE.activeEditor.editorId == "mce_fullscreen")
							var id = tinyMCE.activeEditor.settings.fullscreen_editor_id;
						else
							var id = tinyMCE.activeEditor.editorId;

						var widget = getWidgetById(id.replace("_rich_text_widget", ""));
						editWidgetRequest(widget, "RichEdit");
					}
				});
			},
		theme_advanced_buttons1 : "fullscreen,ajaxSave,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,fontselect,fontsizeselect",
		theme_advanced_buttons2 : "bullist,numlist,|,outdent,indent,|,blockquote,|,link,unlink,cleanup,code,|,forecolor,backcolor,|,hr,emotions,media,image",
		theme_advanced_buttons3 : "tablecontrols,|"
	}];

	function switchWidgetEditabilityRich(id, edit_body) {
    var widget = getWidgetById(id);
    if (widget) {
        if (widget.editing) {
            widget.editing = false;
            var newTitle = document.getElementById(widget.id + "_title_edit").value;
            var encodedText = $('<div/>').text(newTitle).html();
            document.getElementById(widget.id + "_title_text").innerHTML = encodedText;
            if (edit_body) {
                tinyMCE.execCommand("mceRemoveEditor", true, widget.id + "_rich_text_widget");
                editWidgetRequest(widget, "Rich")
            } else {
                editWidgetRequest(widget, "no_body");
                showHide(widget.id + "_image_changer")
            }
            ;var widgetAsJQ = $(document.getElementById(widget.id + "_rich_text_widget"));
            var widgetTables = widgetAsJQ.children("table[cellpadding]");
            $.each(widgetTables, function(key, value) {
                var valAsJQ = $(value);
                var intendedPadding = valAsJQ.attr('cellpadding');
                valAsJQ.find('td').css('padding', intendedPadding)
            })
        } else {
            widget.editing = true;
            var widgetAsJQ = $(document.getElementById(widget.id + "_rich_text_widget"));
            var widgetTables = widgetAsJQ.children("table[cellpadding]");
            $.each(widgetTables, function(key, value) {
                var valAsJQ = $(value);
                valAsJQ.find('td').css('padding', '')
            });
            var titleTextObj = document.getElementById(widget.id + "_title_text");
            var oldTitleText = titleTextObj.innerHTML;
            oldTitleText = oldTitleText.replace(/\"/, "\"");
            oldTitleText = oldTitleText.replace(/\'/g, "&#39;");
            titleTextObj.innerHTML = "<input onMouseDown='stopPropagation(event);' type='text' style='width:100%;' maxlength='90' id='" + widget.id + "_title_edit' value='" + oldTitleText + "'>";
            if (edit_body) {
                tinyMCE.settings = configArray[0];
                tinyMCE.execCommand("mceAddEditor", true, widget.id + "_rich_text_widget")
            } else
                showHide(widget.id + "_image_changer")
        }
    }
}
</script>